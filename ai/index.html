<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AI or Real Challenge</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 30px; background: #111; color: white; }
    iframe { width: 360px; height: 640px; border: none; border-radius: 10px; }
    .btn { padding: 12px 25px; margin: 10px; font-size: 18px; cursor: pointer; border: none; border-radius: 8px; }
    .real { background: #28a745; color: white; }
    .ai { background: #007bff; color: white; }
    .continue { background: #ffc107; color: black; }
  </style>
</head>
<body>
  <div id="app"></div>

  <script>
    const introID = "-a73rOhTppo";
    let videos = [];
    let usedVideos = [];
    let score = 0;

    function setCookie(name, value, hours) {
      let expires = "";
      if (hours) {
        const date = new Date();
        date.setTime(date.getTime() + (hours * 60 * 60 * 1000));
        expires = "; expires=" + date.toUTCString();
      }
      document.cookie = name + "=" + (value || "") + expires + "; path=/";
    }

    function getCookie(name) {
      let nameEQ = name + "=";
      let ca = document.cookie.split(';');
      for (let c of ca) {
        while (c.charAt(0) === ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) === 0)
          return c.substring(nameEQ.length, c.length);
      }
      return null;
    }

    function getRemainingVideos() {
      return videos.filter(v => !usedVideos.includes(v.id));
    }

    async function loadVideos() {
      try {
        const response = await fetch("https://raw.githubusercontent.com/NUNYABUISSNESS12/Playz/main/ai/videos.json");
        videos = await response.json();
      } catch (err) {
        console.error("Failed to load videos JSON", err);
        document.getElementById("app").innerHTML = "<h1>Failed to load video list.</h1>";
        return;
      }

      usedVideos = JSON.parse(getCookie("used_videos") || "[]");

      loadIntro();
    }

    function loadIntro() {
      document.getElementById("app").innerHTML = `
        <h1>AI or Real Challenge</h1>
        <p>Watch the intro, then press continue.</p>
        <iframe src="https://www.youtube.com/embed/${introID}"></iframe><br>
        <button class="btn continue" onclick="startGame()">Continue</button>
      `;
    }

    function startGame() {
      let remaining = getRemainingVideos();
      if (remaining.length === 0) {
        return endGame();
      }

      const randomIndex = Math.floor(Math.random() * remaining.length);
      const current = remaining[randomIndex];

      usedVideos.push(current.id);
      setCookie("used_videos", JSON.stringify(usedVideos), 24);

      document.getElementById("app").innerHTML = `
        <h2>Is this AI or REAL?</h2>
        <iframe src="https://www.youtube.com/embed/${current.id}"></iframe><br>
        <button class="btn real" onclick="checkAnswer('REAL', '${current.answer}')">REAL</button>
        <button class="btn ai" onclick="checkAnswer('AI', '${current.answer}')">AI</button>
      `;
    }

    function checkAnswer(choice, correct) {
      if (choice === correct) score++;
      startGame();
    }

    function endGame() {
      let used = usedVideos.length;
      document.getElementById("app").innerHTML = `
        <h1>All videos completed!</h1>
        <h2>Your Score: ${score} / ${used}</h2>
        <p>You have finished all unique videos saved in your browser.</p>
        <button class="btn continue" onclick="resetVideos()">Reset Videos</button>
      `;
    }

    function resetVideos() {
      setCookie("used_videos", "[]", 24);
      location.reload();
    }

    loadVideos();
  </script>
</body>
</html>
